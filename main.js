/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  PomodoroView: () => PomodoroView,
  VIEW_TYPE_POMODORO: () => VIEW_TYPE_POMODORO,
  default: () => PomodoroPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian = require("obsidian");
var DEFAULT_SETTINGS = {
  workDuration: 25,
  breakDuration: 5,
  longBreakDuration: 15,
  sessionsUntilLongBreak: 4,
  autoStartBreaks: false,
  enableNotifications: true,
  youtubePlaylistUrl: ""
};
var VIEW_TYPE_POMODORO = "pomodoro-view";
var PomodoroView = class extends import_obsidian.ItemView {
  constructor(leaf, plugin) {
    super(leaf);
    this.timer = null;
    this.timeRemaining = 0;
    this.isActive = false;
    this.isBreak = false;
    this.sessionCount = 0;
    this.audioContext = null;
    this.youtubePlayer = null;
    this.plugin = plugin;
    this.timeRemaining = plugin.settings.workDuration * 60;
  }
  getViewType() {
    return VIEW_TYPE_POMODORO;
  }
  getDisplayText() {
    return "Pomodoro Productivity";
  }
  async onOpen() {
    const container = this.containerEl.children[1];
    container.empty();
    container.createEl("div", { cls: "pomodoro-container" });
    this.renderView();
  }
  renderView() {
    const container = this.containerEl.querySelector(".pomodoro-container");
    if (!container.querySelector(".pomodoro-timer-section")) {
      container.empty();
      this.buildInitialView(container);
    } else {
      this.updateTimerDisplay();
    }
  }
  buildInitialView(container) {
    const timerSection = container.createEl("div", { cls: "pomodoro-timer-section" });
    const timerDisplay = timerSection.createEl("div", { cls: "pomodoro-timer-display" });
    const minutes = Math.floor(this.timeRemaining / 60);
    const seconds = this.timeRemaining % 60;
    timerDisplay.textContent = `${minutes.toString().padStart(2, "0")}:${seconds.toString().padStart(2, "0")}`;
    const timerProgress = timerSection.createEl("div", { cls: "pomodoro-progress-container" });
    const progressBar = timerProgress.createEl("div", { cls: "pomodoro-progress-bar" });
    const totalTime = this.isBreak ? (this.sessionCount % this.plugin.settings.sessionsUntilLongBreak === 0 && this.sessionCount > 0 ? this.plugin.settings.longBreakDuration : this.plugin.settings.breakDuration) * 60 : this.plugin.settings.workDuration * 60;
    const progress = (totalTime - this.timeRemaining) / totalTime * 100;
    progressBar.style.width = `${progress}%`;
    const timerControls = timerSection.createEl("div", { cls: "pomodoro-controls" });
    const startBtn = timerControls.createEl("button", {
      cls: this.isActive ? "pomodoro-btn pause" : "pomodoro-btn start",
      text: this.isActive ? "Pause" : "Start"
    });
    startBtn.onclick = () => this.toggleTimer();
    const resetBtn = timerControls.createEl("button", { cls: "pomodoro-btn reset", text: "Reset" });
    resetBtn.onclick = () => this.resetTimer();
    const statusDiv = timerSection.createEl("div", { cls: "pomodoro-status" });
    statusDiv.textContent = this.isBreak ? "Break Time" : `Work Session ${this.sessionCount + 1}`;
    const musicSection = container.createEl("div", { cls: "pomodoro-music-section" });
    musicSection.createEl("h3", { text: "Background Music" });
    const youtubeContainer = musicSection.createEl("div", { cls: "pomodoro-youtube-container" });
    if (this.plugin.settings.youtubePlaylistUrl) {
      this.youtubePlayer = youtubeContainer.createEl("iframe", {
        cls: "pomodoro-youtube-iframe",
        attr: {
          src: this.convertToEmbedUrl(this.plugin.settings.youtubePlaylistUrl),
          frameborder: "0",
          allowfullscreen: "true",
          allow: "autoplay; encrypted-media"
        }
      });
    } else {
      const placeholder = youtubeContainer.createEl("div", {
        cls: "pomodoro-youtube-placeholder",
        text: "Configure YouTube playlist URL in settings"
      });
      this.youtubePlayer = null;
    }
    const urlContainer = musicSection.createEl("div", { cls: "pomodoro-url-container" });
    const urlInput = urlContainer.createEl("input", {
      cls: "pomodoro-url-input",
      attr: {
        type: "text",
        placeholder: "Enter YouTube playlist or video URL..."
      }
    });
    urlInput.value = this.plugin.settings.youtubePlaylistUrl;
    const updateBtn = urlContainer.createEl("button", {
      cls: "pomodoro-btn update-music",
      text: "Update Music"
    });
    updateBtn.onclick = () => {
      this.plugin.settings.youtubePlaylistUrl = urlInput.value;
      this.plugin.saveSettings();
      this.updateYouTubePlayer();
    };
  }
  updateTimerDisplay() {
    const timerDisplay = this.containerEl.querySelector(".pomodoro-timer-display");
    const progressBar = this.containerEl.querySelector(".pomodoro-progress-bar");
    const statusDiv = this.containerEl.querySelector(".pomodoro-status");
    const startBtn = this.containerEl.querySelector(".pomodoro-controls button");
    if (timerDisplay) {
      const minutes = Math.floor(this.timeRemaining / 60);
      const seconds = this.timeRemaining % 60;
      timerDisplay.textContent = `${minutes.toString().padStart(2, "0")}:${seconds.toString().padStart(2, "0")}`;
    }
    if (progressBar) {
      const totalTime = this.isBreak ? (this.sessionCount % this.plugin.settings.sessionsUntilLongBreak === 0 && this.sessionCount > 0 ? this.plugin.settings.longBreakDuration : this.plugin.settings.breakDuration) * 60 : this.plugin.settings.workDuration * 60;
      const progress = (totalTime - this.timeRemaining) / totalTime * 100;
      progressBar.style.width = `${progress}%`;
    }
    if (statusDiv) {
      statusDiv.textContent = this.isBreak ? "Break Time" : `Work Session ${this.sessionCount + 1}`;
    }
    if (startBtn) {
      startBtn.textContent = this.isActive ? "Pause" : "Start";
      startBtn.className = this.isActive ? "pomodoro-btn pause" : "pomodoro-btn start";
    }
  }
  updateYouTubePlayer() {
    const youtubeContainer = this.containerEl.querySelector(".pomodoro-youtube-container");
    if (youtubeContainer) {
      youtubeContainer.empty();
      if (this.plugin.settings.youtubePlaylistUrl) {
        this.youtubePlayer = youtubeContainer.createEl("iframe", {
          cls: "pomodoro-youtube-iframe",
          attr: {
            src: this.convertToEmbedUrl(this.plugin.settings.youtubePlaylistUrl),
            frameborder: "0",
            allowfullscreen: "true",
            allow: "autoplay; encrypted-media",
            id: "youtube-player"
          }
        });
      } else {
        const placeholder = youtubeContainer.createEl("div", {
          cls: "pomodoro-youtube-placeholder",
          text: "Configure YouTube playlist URL in settings"
        });
        this.youtubePlayer = null;
      }
    }
  }
  convertToEmbedUrl(url) {
    var _a, _b;
    if (url.includes("playlist?list=")) {
      const playlistId = (_a = url.split("list=")[1]) == null ? void 0 : _a.split("&")[0];
      return `https://www.youtube.com/embed/videoseries?list=${playlistId}`;
    } else if (url.includes("watch?v=")) {
      const videoId = (_b = url.split("v=")[1]) == null ? void 0 : _b.split("&")[0];
      return `https://www.youtube.com/embed/${videoId}`;
    }
    return url;
  }
  toggleTimer() {
    if (this.isActive) {
      this.pauseTimer();
    } else {
      this.startTimer();
    }
  }
  startTimer() {
    this.isActive = true;
    this.timer = window.setInterval(() => {
      this.timeRemaining--;
      if (this.timeRemaining <= 0) {
        this.onTimerComplete();
      }
      this.updateTimerDisplay();
    }, 1e3);
    this.updateTimerDisplay();
  }
  pauseTimer() {
    this.isActive = false;
    if (this.timer) {
      clearInterval(this.timer);
      this.timer = null;
    }
    this.updateTimerDisplay();
  }
  resetTimer() {
    this.pauseTimer();
    this.timeRemaining = this.isBreak ? (this.sessionCount % this.plugin.settings.sessionsUntilLongBreak === 0 && this.sessionCount > 0 ? this.plugin.settings.longBreakDuration : this.plugin.settings.breakDuration) * 60 : this.plugin.settings.workDuration * 60;
    this.updateTimerDisplay();
  }
  playNotificationSound() {
    try {
      if (!this.audioContext) {
        this.audioContext = new (window.AudioContext || window.webkitAudioContext)();
      }
      const ctx = this.audioContext;
      const now = ctx.currentTime;
      const frequencies = [523.25, 659.25, 783.99];
      frequencies.forEach((freq, index) => {
        const oscillator = ctx.createOscillator();
        const gainNode = ctx.createGain();
        oscillator.connect(gainNode);
        gainNode.connect(ctx.destination);
        oscillator.frequency.setValueAtTime(freq, now + index * 0.2);
        oscillator.type = "sine";
        gainNode.gain.setValueAtTime(0, now + index * 0.2);
        gainNode.gain.linearRampToValueAtTime(0.3, now + index * 0.2 + 0.05);
        gainNode.gain.linearRampToValueAtTime(0, now + index * 0.2 + 0.3);
        oscillator.start(now + index * 0.2);
        oscillator.stop(now + index * 0.2 + 0.3);
      });
    } catch (error) {
      console.log("Could not play notification sound:", error);
    }
  }
  async onTimerComplete() {
    this.pauseTimer();
    this.playNotificationSound();
    if (this.plugin.settings.enableNotifications) {
      new import_obsidian.Notice(this.isBreak ? "Break time is over!" : "Work session complete!");
    }
    if (!this.isBreak) {
      this.sessionCount++;
      this.isBreak = true;
      const isLongBreak = this.sessionCount % this.plugin.settings.sessionsUntilLongBreak === 0;
      this.timeRemaining = (isLongBreak ? this.plugin.settings.longBreakDuration : this.plugin.settings.breakDuration) * 60;
    } else {
      this.isBreak = false;
      this.timeRemaining = this.plugin.settings.workDuration * 60;
    }
    if (this.plugin.settings.autoStartBreaks) {
      setTimeout(() => this.startTimer(), 1e3);
    }
    this.updateTimerDisplay();
  }
  async onClose() {
    if (this.timer) {
      clearInterval(this.timer);
    }
    if (this.audioContext) {
      this.audioContext.close();
      this.audioContext = null;
    }
  }
};
var PomodoroPlugin = class extends import_obsidian.Plugin {
  async onload() {
    await this.loadSettings();
    this.registerView(
      VIEW_TYPE_POMODORO,
      (leaf) => new PomodoroView(leaf, this)
    );
    this.addRibbonIcon("clock", "Open Pomodoro Productivity", () => {
      this.activateView();
    });
    this.addCommand({
      id: "open-pomodoro-view",
      name: "Open Pomodoro Productivity",
      callback: () => {
        this.activateView();
      }
    });
    this.addSettingTab(new PomodoroSettingTab(this.app, this));
  }
  async activateView() {
    const { workspace } = this.app;
    let leaf = null;
    const leaves = workspace.getLeavesOfType(VIEW_TYPE_POMODORO);
    if (leaves.length > 0) {
      leaf = leaves[0];
    } else {
      leaf = workspace.getRightLeaf(false);
      await leaf.setViewState({ type: VIEW_TYPE_POMODORO, active: true });
    }
    workspace.revealLeaf(leaf);
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
};
var PomodoroSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "Pomodoro Productivity Settings" });
    new import_obsidian.Setting(containerEl).setName("Work duration").setDesc("Duration of work sessions in minutes").addText((text) => text.setPlaceholder("25").setValue(this.plugin.settings.workDuration.toString()).onChange(async (value) => {
      this.plugin.settings.workDuration = parseInt(value) || 25;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Break duration").setDesc("Duration of short breaks in minutes").addText((text) => text.setPlaceholder("5").setValue(this.plugin.settings.breakDuration.toString()).onChange(async (value) => {
      this.plugin.settings.breakDuration = parseInt(value) || 5;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Long break duration").setDesc("Duration of long breaks in minutes").addText((text) => text.setPlaceholder("15").setValue(this.plugin.settings.longBreakDuration.toString()).onChange(async (value) => {
      this.plugin.settings.longBreakDuration = parseInt(value) || 15;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Sessions until long break").setDesc("Number of work sessions before a long break").addText((text) => text.setPlaceholder("4").setValue(this.plugin.settings.sessionsUntilLongBreak.toString()).onChange(async (value) => {
      this.plugin.settings.sessionsUntilLongBreak = parseInt(value) || 4;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Auto-start breaks").setDesc("Automatically start break timers after work sessions").addToggle((toggle) => toggle.setValue(this.plugin.settings.autoStartBreaks).onChange(async (value) => {
      this.plugin.settings.autoStartBreaks = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Enable notifications").setDesc("Show notifications when timers complete").addToggle((toggle) => toggle.setValue(this.plugin.settings.enableNotifications).onChange(async (value) => {
      this.plugin.settings.enableNotifications = value;
      await this.plugin.saveSettings();
    }));
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgQXBwLCBQbHVnaW4sIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcsIFdvcmtzcGFjZUxlYWYsIEl0ZW1WaWV3LCBOb3RpY2UgfSBmcm9tICdvYnNpZGlhbic7XG5cbmludGVyZmFjZSBQb21vZG9yb1NldHRpbmdzIHtcbiAgd29ya0R1cmF0aW9uOiBudW1iZXI7XG4gIGJyZWFrRHVyYXRpb246IG51bWJlcjtcbiAgbG9uZ0JyZWFrRHVyYXRpb246IG51bWJlcjtcbiAgc2Vzc2lvbnNVbnRpbExvbmdCcmVhazogbnVtYmVyO1xuICBhdXRvU3RhcnRCcmVha3M6IGJvb2xlYW47XG4gIGVuYWJsZU5vdGlmaWNhdGlvbnM6IGJvb2xlYW47XG4gIHlvdXR1YmVQbGF5bGlzdFVybDogc3RyaW5nO1xufVxuXG5jb25zdCBERUZBVUxUX1NFVFRJTkdTOiBQb21vZG9yb1NldHRpbmdzID0ge1xuICB3b3JrRHVyYXRpb246IDI1LFxuICBicmVha0R1cmF0aW9uOiA1LFxuICBsb25nQnJlYWtEdXJhdGlvbjogMTUsXG4gIHNlc3Npb25zVW50aWxMb25nQnJlYWs6IDQsXG4gIGF1dG9TdGFydEJyZWFrczogZmFsc2UsXG4gIGVuYWJsZU5vdGlmaWNhdGlvbnM6IHRydWUsXG4gIHlvdXR1YmVQbGF5bGlzdFVybDogJycsXG59O1xuXG5leHBvcnQgY29uc3QgVklFV19UWVBFX1BPTU9ET1JPID0gJ3BvbW9kb3JvLXZpZXcnO1xuXG5leHBvcnQgY2xhc3MgUG9tb2Rvcm9WaWV3IGV4dGVuZHMgSXRlbVZpZXcge1xuICBwcml2YXRlIHBsdWdpbjogUG9tb2Rvcm9QbHVnaW47XG4gIHByaXZhdGUgdGltZXI6IG51bWJlciB8IG51bGwgPSBudWxsO1xuICBwcml2YXRlIHRpbWVSZW1haW5pbmc6IG51bWJlciA9IDA7XG4gIHByaXZhdGUgaXNBY3RpdmU6IGJvb2xlYW4gPSBmYWxzZTtcbiAgcHJpdmF0ZSBpc0JyZWFrOiBib29sZWFuID0gZmFsc2U7XG4gIHByaXZhdGUgc2Vzc2lvbkNvdW50OiBudW1iZXIgPSAwO1xuICBwcml2YXRlIGF1ZGlvQ29udGV4dDogQXVkaW9Db250ZXh0IHwgbnVsbCA9IG51bGw7XG4gIHByaXZhdGUgeW91dHViZVBsYXllcjogSFRNTElGcmFtZUVsZW1lbnQgfCBudWxsID0gbnVsbDtcblxuICBjb25zdHJ1Y3RvcihsZWFmOiBXb3Jrc3BhY2VMZWFmLCBwbHVnaW46IFBvbW9kb3JvUGx1Z2luKSB7XG4gICAgc3VwZXIobGVhZik7XG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gICAgdGhpcy50aW1lUmVtYWluaW5nID0gcGx1Z2luLnNldHRpbmdzLndvcmtEdXJhdGlvbiAqIDYwO1xuICB9XG5cbiAgZ2V0Vmlld1R5cGUoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gVklFV19UWVBFX1BPTU9ET1JPO1xuICB9XG5cbiAgZ2V0RGlzcGxheVRleHQoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gJ1BvbW9kb3JvIFByb2R1Y3Rpdml0eSc7XG4gIH1cblxuICBhc3luYyBvbk9wZW4oKSB7XG4gICAgY29uc3QgY29udGFpbmVyID0gdGhpcy5jb250YWluZXJFbC5jaGlsZHJlblsxXTtcbiAgICBjb250YWluZXIuZW1wdHkoKTtcbiAgICBjb250YWluZXIuY3JlYXRlRWwoJ2RpdicsIHsgY2xzOiAncG9tb2Rvcm8tY29udGFpbmVyJyB9KTtcbiAgICB0aGlzLnJlbmRlclZpZXcoKTtcbiAgfVxuXG4gIHByaXZhdGUgcmVuZGVyVmlldygpIHtcbiAgICBjb25zdCBjb250YWluZXIgPSB0aGlzLmNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3IoJy5wb21vZG9yby1jb250YWluZXInKSBhcyBIVE1MRWxlbWVudDtcbiAgICBcbiAgICAvLyBPbmx5IGNsZWFyIGFuZCByZWJ1aWxkIGlmIHRoaXMgaXMgdGhlIGZpcnN0IHJlbmRlciBvciBhIG1ham9yIHN0YXRlIGNoYW5nZVxuICAgIGlmICghY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5wb21vZG9yby10aW1lci1zZWN0aW9uJykpIHtcbiAgICAgIGNvbnRhaW5lci5lbXB0eSgpO1xuICAgICAgdGhpcy5idWlsZEluaXRpYWxWaWV3KGNvbnRhaW5lcik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMudXBkYXRlVGltZXJEaXNwbGF5KCk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBidWlsZEluaXRpYWxWaWV3KGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpIHtcblxuICAgIC8vIFRpbWVyIFNlY3Rpb25cbiAgICBjb25zdCB0aW1lclNlY3Rpb24gPSBjb250YWluZXIuY3JlYXRlRWwoJ2RpdicsIHsgY2xzOiAncG9tb2Rvcm8tdGltZXItc2VjdGlvbicgfSk7XG4gICAgXG4gICAgY29uc3QgdGltZXJEaXNwbGF5ID0gdGltZXJTZWN0aW9uLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ3BvbW9kb3JvLXRpbWVyLWRpc3BsYXknIH0pO1xuICAgIGNvbnN0IG1pbnV0ZXMgPSBNYXRoLmZsb29yKHRoaXMudGltZVJlbWFpbmluZyAvIDYwKTtcbiAgICBjb25zdCBzZWNvbmRzID0gdGhpcy50aW1lUmVtYWluaW5nICUgNjA7XG4gICAgdGltZXJEaXNwbGF5LnRleHRDb250ZW50ID0gYCR7bWludXRlcy50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyl9OiR7c2Vjb25kcy50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyl9YDtcbiAgICBcbiAgICBjb25zdCB0aW1lclByb2dyZXNzID0gdGltZXJTZWN0aW9uLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ3BvbW9kb3JvLXByb2dyZXNzLWNvbnRhaW5lcicgfSk7XG4gICAgY29uc3QgcHJvZ3Jlc3NCYXIgPSB0aW1lclByb2dyZXNzLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ3BvbW9kb3JvLXByb2dyZXNzLWJhcicgfSk7XG4gICAgY29uc3QgdG90YWxUaW1lID0gdGhpcy5pc0JyZWFrIFxuICAgICAgPyAodGhpcy5zZXNzaW9uQ291bnQgJSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZXNzaW9uc1VudGlsTG9uZ0JyZWFrID09PSAwICYmIHRoaXMuc2Vzc2lvbkNvdW50ID4gMCBcbiAgICAgICAgPyB0aGlzLnBsdWdpbi5zZXR0aW5ncy5sb25nQnJlYWtEdXJhdGlvbiBcbiAgICAgICAgOiB0aGlzLnBsdWdpbi5zZXR0aW5ncy5icmVha0R1cmF0aW9uKSAqIDYwXG4gICAgICA6IHRoaXMucGx1Z2luLnNldHRpbmdzLndvcmtEdXJhdGlvbiAqIDYwO1xuICAgIGNvbnN0IHByb2dyZXNzID0gKCh0b3RhbFRpbWUgLSB0aGlzLnRpbWVSZW1haW5pbmcpIC8gdG90YWxUaW1lKSAqIDEwMDtcbiAgICBwcm9ncmVzc0Jhci5zdHlsZS53aWR0aCA9IGAke3Byb2dyZXNzfSVgO1xuXG4gICAgY29uc3QgdGltZXJDb250cm9scyA9IHRpbWVyU2VjdGlvbi5jcmVhdGVFbCgnZGl2JywgeyBjbHM6ICdwb21vZG9yby1jb250cm9scycgfSk7XG4gICAgY29uc3Qgc3RhcnRCdG4gPSB0aW1lckNvbnRyb2xzLmNyZWF0ZUVsKCdidXR0b24nLCB7IFxuICAgICAgY2xzOiB0aGlzLmlzQWN0aXZlID8gJ3BvbW9kb3JvLWJ0biBwYXVzZScgOiAncG9tb2Rvcm8tYnRuIHN0YXJ0JyxcbiAgICAgIHRleHQ6IHRoaXMuaXNBY3RpdmUgPyAnUGF1c2UnIDogJ1N0YXJ0J1xuICAgIH0pO1xuICAgIHN0YXJ0QnRuLm9uY2xpY2sgPSAoKSA9PiB0aGlzLnRvZ2dsZVRpbWVyKCk7XG5cbiAgICBjb25zdCByZXNldEJ0biA9IHRpbWVyQ29udHJvbHMuY3JlYXRlRWwoJ2J1dHRvbicsIHsgY2xzOiAncG9tb2Rvcm8tYnRuIHJlc2V0JywgdGV4dDogJ1Jlc2V0JyB9KTtcbiAgICByZXNldEJ0bi5vbmNsaWNrID0gKCkgPT4gdGhpcy5yZXNldFRpbWVyKCk7XG5cbiAgICBjb25zdCBzdGF0dXNEaXYgPSB0aW1lclNlY3Rpb24uY3JlYXRlRWwoJ2RpdicsIHsgY2xzOiAncG9tb2Rvcm8tc3RhdHVzJyB9KTtcbiAgICBzdGF0dXNEaXYudGV4dENvbnRlbnQgPSB0aGlzLmlzQnJlYWsgPyAnQnJlYWsgVGltZScgOiBgV29yayBTZXNzaW9uICR7dGhpcy5zZXNzaW9uQ291bnQgKyAxfWA7XG5cbiAgICAvLyBZb3VUdWJlIE11c2ljIFNlY3Rpb25cbiAgICBjb25zdCBtdXNpY1NlY3Rpb24gPSBjb250YWluZXIuY3JlYXRlRWwoJ2RpdicsIHsgY2xzOiAncG9tb2Rvcm8tbXVzaWMtc2VjdGlvbicgfSk7XG4gICAgbXVzaWNTZWN0aW9uLmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogJ0JhY2tncm91bmQgTXVzaWMnIH0pO1xuXG4gICAgY29uc3QgeW91dHViZUNvbnRhaW5lciA9IG11c2ljU2VjdGlvbi5jcmVhdGVFbCgnZGl2JywgeyBjbHM6ICdwb21vZG9yby15b3V0dWJlLWNvbnRhaW5lcicgfSk7XG4gICAgXG4gICAgaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLnlvdXR1YmVQbGF5bGlzdFVybCkge1xuICAgICAgdGhpcy55b3V0dWJlUGxheWVyID0geW91dHViZUNvbnRhaW5lci5jcmVhdGVFbCgnaWZyYW1lJywge1xuICAgICAgICBjbHM6ICdwb21vZG9yby15b3V0dWJlLWlmcmFtZScsXG4gICAgICAgIGF0dHI6IHtcbiAgICAgICAgICBzcmM6IHRoaXMuY29udmVydFRvRW1iZWRVcmwodGhpcy5wbHVnaW4uc2V0dGluZ3MueW91dHViZVBsYXlsaXN0VXJsKSxcbiAgICAgICAgICBmcmFtZWJvcmRlcjogJzAnLFxuICAgICAgICAgIGFsbG93ZnVsbHNjcmVlbjogJ3RydWUnLFxuICAgICAgICAgIGFsbG93OiAnYXV0b3BsYXk7IGVuY3J5cHRlZC1tZWRpYSdcbiAgICAgICAgfVxuICAgICAgfSkgYXMgSFRNTElGcmFtZUVsZW1lbnQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IHBsYWNlaG9sZGVyID0geW91dHViZUNvbnRhaW5lci5jcmVhdGVFbCgnZGl2JywgeyBcbiAgICAgICAgY2xzOiAncG9tb2Rvcm8teW91dHViZS1wbGFjZWhvbGRlcicsXG4gICAgICAgIHRleHQ6ICdDb25maWd1cmUgWW91VHViZSBwbGF5bGlzdCBVUkwgaW4gc2V0dGluZ3MnXG4gICAgICB9KTtcbiAgICAgIHRoaXMueW91dHViZVBsYXllciA9IG51bGw7XG4gICAgfVxuXG4gICAgLy8gTXVzaWMgVVJMIGlucHV0XG4gICAgY29uc3QgdXJsQ29udGFpbmVyID0gbXVzaWNTZWN0aW9uLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ3BvbW9kb3JvLXVybC1jb250YWluZXInIH0pO1xuICAgIFxuICAgIGNvbnN0IHVybElucHV0ID0gdXJsQ29udGFpbmVyLmNyZWF0ZUVsKCdpbnB1dCcsIHtcbiAgICAgIGNsczogJ3BvbW9kb3JvLXVybC1pbnB1dCcsXG4gICAgICBhdHRyOiB7XG4gICAgICAgIHR5cGU6ICd0ZXh0JyxcbiAgICAgICAgcGxhY2Vob2xkZXI6ICdFbnRlciBZb3VUdWJlIHBsYXlsaXN0IG9yIHZpZGVvIFVSTC4uLidcbiAgICAgIH1cbiAgICB9KSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuICAgIFxuICAgIHVybElucHV0LnZhbHVlID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MueW91dHViZVBsYXlsaXN0VXJsO1xuXG4gICAgY29uc3QgdXBkYXRlQnRuID0gdXJsQ29udGFpbmVyLmNyZWF0ZUVsKCdidXR0b24nLCB7XG4gICAgICBjbHM6ICdwb21vZG9yby1idG4gdXBkYXRlLW11c2ljJyxcbiAgICAgIHRleHQ6ICdVcGRhdGUgTXVzaWMnXG4gICAgfSk7XG4gICAgXG4gICAgdXBkYXRlQnRuLm9uY2xpY2sgPSAoKSA9PiB7XG4gICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy55b3V0dWJlUGxheWxpc3RVcmwgPSB1cmxJbnB1dC52YWx1ZTtcbiAgICAgIHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgdGhpcy51cGRhdGVZb3VUdWJlUGxheWVyKCk7XG4gICAgfTtcbiAgfVxuXG4gIHByaXZhdGUgdXBkYXRlVGltZXJEaXNwbGF5KCkge1xuICAgIGNvbnN0IHRpbWVyRGlzcGxheSA9IHRoaXMuY29udGFpbmVyRWwucXVlcnlTZWxlY3RvcignLnBvbW9kb3JvLXRpbWVyLWRpc3BsYXknKSBhcyBIVE1MRWxlbWVudDtcbiAgICBjb25zdCBwcm9ncmVzc0JhciA9IHRoaXMuY29udGFpbmVyRWwucXVlcnlTZWxlY3RvcignLnBvbW9kb3JvLXByb2dyZXNzLWJhcicpIGFzIEhUTUxFbGVtZW50O1xuICAgIGNvbnN0IHN0YXR1c0RpdiA9IHRoaXMuY29udGFpbmVyRWwucXVlcnlTZWxlY3RvcignLnBvbW9kb3JvLXN0YXR1cycpIGFzIEhUTUxFbGVtZW50O1xuICAgIGNvbnN0IHN0YXJ0QnRuID0gdGhpcy5jb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKCcucG9tb2Rvcm8tY29udHJvbHMgYnV0dG9uJykgYXMgSFRNTEJ1dHRvbkVsZW1lbnQ7XG5cbiAgICBpZiAodGltZXJEaXNwbGF5KSB7XG4gICAgICBjb25zdCBtaW51dGVzID0gTWF0aC5mbG9vcih0aGlzLnRpbWVSZW1haW5pbmcgLyA2MCk7XG4gICAgICBjb25zdCBzZWNvbmRzID0gdGhpcy50aW1lUmVtYWluaW5nICUgNjA7XG4gICAgICB0aW1lckRpc3BsYXkudGV4dENvbnRlbnQgPSBgJHttaW51dGVzLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKX06JHtzZWNvbmRzLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKX1gO1xuICAgIH1cblxuICAgIGlmIChwcm9ncmVzc0Jhcikge1xuICAgICAgY29uc3QgdG90YWxUaW1lID0gdGhpcy5pc0JyZWFrIFxuICAgICAgICA/ICh0aGlzLnNlc3Npb25Db3VudCAlIHRoaXMucGx1Z2luLnNldHRpbmdzLnNlc3Npb25zVW50aWxMb25nQnJlYWsgPT09IDAgJiYgdGhpcy5zZXNzaW9uQ291bnQgPiAwIFxuICAgICAgICAgID8gdGhpcy5wbHVnaW4uc2V0dGluZ3MubG9uZ0JyZWFrRHVyYXRpb24gXG4gICAgICAgICAgOiB0aGlzLnBsdWdpbi5zZXR0aW5ncy5icmVha0R1cmF0aW9uKSAqIDYwXG4gICAgICAgIDogdGhpcy5wbHVnaW4uc2V0dGluZ3Mud29ya0R1cmF0aW9uICogNjA7XG4gICAgICBjb25zdCBwcm9ncmVzcyA9ICgodG90YWxUaW1lIC0gdGhpcy50aW1lUmVtYWluaW5nKSAvIHRvdGFsVGltZSkgKiAxMDA7XG4gICAgICBwcm9ncmVzc0Jhci5zdHlsZS53aWR0aCA9IGAke3Byb2dyZXNzfSVgO1xuICAgIH1cblxuICAgIGlmIChzdGF0dXNEaXYpIHtcbiAgICAgIHN0YXR1c0Rpdi50ZXh0Q29udGVudCA9IHRoaXMuaXNCcmVhayA/ICdCcmVhayBUaW1lJyA6IGBXb3JrIFNlc3Npb24gJHt0aGlzLnNlc3Npb25Db3VudCArIDF9YDtcbiAgICB9XG5cbiAgICBpZiAoc3RhcnRCdG4pIHtcbiAgICAgIHN0YXJ0QnRuLnRleHRDb250ZW50ID0gdGhpcy5pc0FjdGl2ZSA/ICdQYXVzZScgOiAnU3RhcnQnO1xuICAgICAgc3RhcnRCdG4uY2xhc3NOYW1lID0gdGhpcy5pc0FjdGl2ZSA/ICdwb21vZG9yby1idG4gcGF1c2UnIDogJ3BvbW9kb3JvLWJ0biBzdGFydCc7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSB1cGRhdGVZb3VUdWJlUGxheWVyKCkge1xuICAgIGNvbnN0IHlvdXR1YmVDb250YWluZXIgPSB0aGlzLmNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3IoJy5wb21vZG9yby15b3V0dWJlLWNvbnRhaW5lcicpIGFzIEhUTUxFbGVtZW50O1xuICAgIFxuICAgIGlmICh5b3V0dWJlQ29udGFpbmVyKSB7XG4gICAgICB5b3V0dWJlQ29udGFpbmVyLmVtcHR5KCk7XG4gICAgICBcbiAgICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy55b3V0dWJlUGxheWxpc3RVcmwpIHtcbiAgICAgICAgdGhpcy55b3V0dWJlUGxheWVyID0geW91dHViZUNvbnRhaW5lci5jcmVhdGVFbCgnaWZyYW1lJywge1xuICAgICAgICAgIGNsczogJ3BvbW9kb3JvLXlvdXR1YmUtaWZyYW1lJyxcbiAgICAgICAgICBhdHRyOiB7XG4gICAgICAgICAgICBzcmM6IHRoaXMuY29udmVydFRvRW1iZWRVcmwodGhpcy5wbHVnaW4uc2V0dGluZ3MueW91dHViZVBsYXlsaXN0VXJsKSxcbiAgICAgICAgICAgIGZyYW1lYm9yZGVyOiAnMCcsXG4gICAgICAgICAgICBhbGxvd2Z1bGxzY3JlZW46ICd0cnVlJyxcbiAgICAgICAgICAgIGFsbG93OiAnYXV0b3BsYXk7IGVuY3J5cHRlZC1tZWRpYScsXG4gICAgICAgICAgICBpZDogJ3lvdXR1YmUtcGxheWVyJ1xuICAgICAgICAgIH1cbiAgICAgICAgfSkgYXMgSFRNTElGcmFtZUVsZW1lbnQ7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBwbGFjZWhvbGRlciA9IHlvdXR1YmVDb250YWluZXIuY3JlYXRlRWwoJ2RpdicsIHsgXG4gICAgICAgICAgY2xzOiAncG9tb2Rvcm8teW91dHViZS1wbGFjZWhvbGRlcicsXG4gICAgICAgICAgdGV4dDogJ0NvbmZpZ3VyZSBZb3VUdWJlIHBsYXlsaXN0IFVSTCBpbiBzZXR0aW5ncydcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMueW91dHViZVBsYXllciA9IG51bGw7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBjb252ZXJ0VG9FbWJlZFVybCh1cmw6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgaWYgKHVybC5pbmNsdWRlcygncGxheWxpc3Q/bGlzdD0nKSkge1xuICAgICAgY29uc3QgcGxheWxpc3RJZCA9IHVybC5zcGxpdCgnbGlzdD0nKVsxXT8uc3BsaXQoJyYnKVswXTtcbiAgICAgIHJldHVybiBgaHR0cHM6Ly93d3cueW91dHViZS5jb20vZW1iZWQvdmlkZW9zZXJpZXM/bGlzdD0ke3BsYXlsaXN0SWR9YDtcbiAgICB9IGVsc2UgaWYgKHVybC5pbmNsdWRlcygnd2F0Y2g/dj0nKSkge1xuICAgICAgY29uc3QgdmlkZW9JZCA9IHVybC5zcGxpdCgndj0nKVsxXT8uc3BsaXQoJyYnKVswXTtcbiAgICAgIHJldHVybiBgaHR0cHM6Ly93d3cueW91dHViZS5jb20vZW1iZWQvJHt2aWRlb0lkfWA7XG4gICAgfVxuICAgIHJldHVybiB1cmw7XG4gIH1cblxuICBwcml2YXRlIHRvZ2dsZVRpbWVyKCkge1xuICAgIGlmICh0aGlzLmlzQWN0aXZlKSB7XG4gICAgICB0aGlzLnBhdXNlVGltZXIoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5zdGFydFRpbWVyKCk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBzdGFydFRpbWVyKCkge1xuICAgIHRoaXMuaXNBY3RpdmUgPSB0cnVlO1xuICAgIHRoaXMudGltZXIgPSB3aW5kb3cuc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgdGhpcy50aW1lUmVtYWluaW5nLS07XG4gICAgICBpZiAodGhpcy50aW1lUmVtYWluaW5nIDw9IDApIHtcbiAgICAgICAgdGhpcy5vblRpbWVyQ29tcGxldGUoKTtcbiAgICAgIH1cbiAgICAgIHRoaXMudXBkYXRlVGltZXJEaXNwbGF5KCk7XG4gICAgfSwgMTAwMCk7XG4gICAgdGhpcy51cGRhdGVUaW1lckRpc3BsYXkoKTtcbiAgfVxuXG4gIHByaXZhdGUgcGF1c2VUaW1lcigpIHtcbiAgICB0aGlzLmlzQWN0aXZlID0gZmFsc2U7XG4gICAgaWYgKHRoaXMudGltZXIpIHtcbiAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy50aW1lcik7XG4gICAgICB0aGlzLnRpbWVyID0gbnVsbDtcbiAgICB9XG4gICAgdGhpcy51cGRhdGVUaW1lckRpc3BsYXkoKTtcbiAgfVxuXG4gIHByaXZhdGUgcmVzZXRUaW1lcigpIHtcbiAgICB0aGlzLnBhdXNlVGltZXIoKTtcbiAgICB0aGlzLnRpbWVSZW1haW5pbmcgPSB0aGlzLmlzQnJlYWsgXG4gICAgICA/ICh0aGlzLnNlc3Npb25Db3VudCAlIHRoaXMucGx1Z2luLnNldHRpbmdzLnNlc3Npb25zVW50aWxMb25nQnJlYWsgPT09IDAgJiYgdGhpcy5zZXNzaW9uQ291bnQgPiAwIFxuICAgICAgICA/IHRoaXMucGx1Z2luLnNldHRpbmdzLmxvbmdCcmVha0R1cmF0aW9uIFxuICAgICAgICA6IHRoaXMucGx1Z2luLnNldHRpbmdzLmJyZWFrRHVyYXRpb24pICogNjBcbiAgICAgIDogdGhpcy5wbHVnaW4uc2V0dGluZ3Mud29ya0R1cmF0aW9uICogNjA7XG4gICAgdGhpcy51cGRhdGVUaW1lckRpc3BsYXkoKTtcbiAgfVxuXG4gIHByaXZhdGUgcGxheU5vdGlmaWNhdGlvblNvdW5kKCkge1xuICAgIHRyeSB7XG4gICAgICAvLyBDcmVhdGUgYXVkaW8gY29udGV4dCBpZiBpdCBkb2Vzbid0IGV4aXN0XG4gICAgICBpZiAoIXRoaXMuYXVkaW9Db250ZXh0KSB7XG4gICAgICAgIHRoaXMuYXVkaW9Db250ZXh0ID0gbmV3ICh3aW5kb3cuQXVkaW9Db250ZXh0IHx8ICh3aW5kb3cgYXMgYW55KS53ZWJraXRBdWRpb0NvbnRleHQpKCk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGN0eCA9IHRoaXMuYXVkaW9Db250ZXh0O1xuICAgICAgY29uc3Qgbm93ID0gY3R4LmN1cnJlbnRUaW1lO1xuXG4gICAgICAvLyBDcmVhdGUgYSBwbGVhc2FudCBub3RpZmljYXRpb24gc291bmQgKDMgYXNjZW5kaW5nIHRvbmVzKVxuICAgICAgY29uc3QgZnJlcXVlbmNpZXMgPSBbNTIzLjI1LCA2NTkuMjUsIDc4My45OV07IC8vIEM1LCBFNSwgRzVcbiAgICAgIFxuICAgICAgZnJlcXVlbmNpZXMuZm9yRWFjaCgoZnJlcSwgaW5kZXgpID0+IHtcbiAgICAgICAgY29uc3Qgb3NjaWxsYXRvciA9IGN0eC5jcmVhdGVPc2NpbGxhdG9yKCk7XG4gICAgICAgIGNvbnN0IGdhaW5Ob2RlID0gY3R4LmNyZWF0ZUdhaW4oKTtcbiAgICAgICAgXG4gICAgICAgIG9zY2lsbGF0b3IuY29ubmVjdChnYWluTm9kZSk7XG4gICAgICAgIGdhaW5Ob2RlLmNvbm5lY3QoY3R4LmRlc3RpbmF0aW9uKTtcbiAgICAgICAgXG4gICAgICAgIG9zY2lsbGF0b3IuZnJlcXVlbmN5LnNldFZhbHVlQXRUaW1lKGZyZXEsIG5vdyArIGluZGV4ICogMC4yKTtcbiAgICAgICAgb3NjaWxsYXRvci50eXBlID0gJ3NpbmUnO1xuICAgICAgICBcbiAgICAgICAgZ2Fpbk5vZGUuZ2Fpbi5zZXRWYWx1ZUF0VGltZSgwLCBub3cgKyBpbmRleCAqIDAuMik7XG4gICAgICAgIGdhaW5Ob2RlLmdhaW4ubGluZWFyUmFtcFRvVmFsdWVBdFRpbWUoMC4zLCBub3cgKyBpbmRleCAqIDAuMiArIDAuMDUpO1xuICAgICAgICBnYWluTm9kZS5nYWluLmxpbmVhclJhbXBUb1ZhbHVlQXRUaW1lKDAsIG5vdyArIGluZGV4ICogMC4yICsgMC4zKTtcbiAgICAgICAgXG4gICAgICAgIG9zY2lsbGF0b3Iuc3RhcnQobm93ICsgaW5kZXggKiAwLjIpO1xuICAgICAgICBvc2NpbGxhdG9yLnN0b3Aobm93ICsgaW5kZXggKiAwLjIgKyAwLjMpO1xuICAgICAgfSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUubG9nKCdDb3VsZCBub3QgcGxheSBub3RpZmljYXRpb24gc291bmQ6JywgZXJyb3IpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgb25UaW1lckNvbXBsZXRlKCkge1xuICAgIHRoaXMucGF1c2VUaW1lcigpO1xuICAgIFxuICAgIC8vIFBsYXkgbm90aWZpY2F0aW9uIHNvdW5kXG4gICAgdGhpcy5wbGF5Tm90aWZpY2F0aW9uU291bmQoKTtcbiAgICBcbiAgICBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlTm90aWZpY2F0aW9ucykge1xuICAgICAgbmV3IE5vdGljZSh0aGlzLmlzQnJlYWsgPyAnQnJlYWsgdGltZSBpcyBvdmVyIScgOiAnV29yayBzZXNzaW9uIGNvbXBsZXRlIScpO1xuICAgIH1cblxuICAgIGlmICghdGhpcy5pc0JyZWFrKSB7XG4gICAgICAvLyBXb3JrIHNlc3Npb24gY29tcGxldGVkXG4gICAgICB0aGlzLnNlc3Npb25Db3VudCsrO1xuICAgICAgXG4gICAgICAvLyBTd2l0Y2ggdG8gYnJlYWtcbiAgICAgIHRoaXMuaXNCcmVhayA9IHRydWU7XG4gICAgICBjb25zdCBpc0xvbmdCcmVhayA9IHRoaXMuc2Vzc2lvbkNvdW50ICUgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2Vzc2lvbnNVbnRpbExvbmdCcmVhayA9PT0gMDtcbiAgICAgIHRoaXMudGltZVJlbWFpbmluZyA9IChpc0xvbmdCcmVhayA/IHRoaXMucGx1Z2luLnNldHRpbmdzLmxvbmdCcmVha0R1cmF0aW9uIDogdGhpcy5wbHVnaW4uc2V0dGluZ3MuYnJlYWtEdXJhdGlvbikgKiA2MDtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gQnJlYWsgY29tcGxldGVkXG4gICAgICB0aGlzLmlzQnJlYWsgPSBmYWxzZTtcbiAgICAgIHRoaXMudGltZVJlbWFpbmluZyA9IHRoaXMucGx1Z2luLnNldHRpbmdzLndvcmtEdXJhdGlvbiAqIDYwO1xuICAgIH1cblxuICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5hdXRvU3RhcnRCcmVha3MpIHtcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4gdGhpcy5zdGFydFRpbWVyKCksIDEwMDApO1xuICAgIH1cblxuICAgIHRoaXMudXBkYXRlVGltZXJEaXNwbGF5KCk7XG4gIH1cblxuICBhc3luYyBvbkNsb3NlKCkge1xuICAgIGlmICh0aGlzLnRpbWVyKSB7XG4gICAgICBjbGVhckludGVydmFsKHRoaXMudGltZXIpO1xuICAgIH1cbiAgICBcbiAgICAvLyBDbGVhbiB1cCBhdWRpbyBjb250ZXh0XG4gICAgaWYgKHRoaXMuYXVkaW9Db250ZXh0KSB7XG4gICAgICB0aGlzLmF1ZGlvQ29udGV4dC5jbG9zZSgpO1xuICAgICAgdGhpcy5hdWRpb0NvbnRleHQgPSBudWxsO1xuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb21vZG9yb1BsdWdpbiBleHRlbmRzIFBsdWdpbiB7XG4gIHNldHRpbmdzOiBQb21vZG9yb1NldHRpbmdzO1xuXG4gIGFzeW5jIG9ubG9hZCgpIHtcbiAgICBhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xuXG4gICAgdGhpcy5yZWdpc3RlclZpZXcoXG4gICAgICBWSUVXX1RZUEVfUE9NT0RPUk8sXG4gICAgICAobGVhZikgPT4gbmV3IFBvbW9kb3JvVmlldyhsZWFmLCB0aGlzKVxuICAgICk7XG5cbiAgICB0aGlzLmFkZFJpYmJvbkljb24oJ2Nsb2NrJywgJ09wZW4gUG9tb2Rvcm8gUHJvZHVjdGl2aXR5JywgKCkgPT4ge1xuICAgICAgdGhpcy5hY3RpdmF0ZVZpZXcoKTtcbiAgICB9KTtcblxuICAgIHRoaXMuYWRkQ29tbWFuZCh7XG4gICAgICBpZDogJ29wZW4tcG9tb2Rvcm8tdmlldycsXG4gICAgICBuYW1lOiAnT3BlbiBQb21vZG9ybyBQcm9kdWN0aXZpdHknLFxuICAgICAgY2FsbGJhY2s6ICgpID0+IHtcbiAgICAgICAgdGhpcy5hY3RpdmF0ZVZpZXcoKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgUG9tb2Rvcm9TZXR0aW5nVGFiKHRoaXMuYXBwLCB0aGlzKSk7XG4gIH1cblxuICBhc3luYyBhY3RpdmF0ZVZpZXcoKSB7XG4gICAgY29uc3QgeyB3b3Jrc3BhY2UgfSA9IHRoaXMuYXBwO1xuICAgIFxuICAgIGxldCBsZWFmOiBXb3Jrc3BhY2VMZWFmIHwgbnVsbCA9IG51bGw7XG4gICAgY29uc3QgbGVhdmVzID0gd29ya3NwYWNlLmdldExlYXZlc09mVHlwZShWSUVXX1RZUEVfUE9NT0RPUk8pO1xuXG4gICAgaWYgKGxlYXZlcy5sZW5ndGggPiAwKSB7XG4gICAgICBsZWFmID0gbGVhdmVzWzBdO1xuICAgIH0gZWxzZSB7XG4gICAgICBsZWFmID0gd29ya3NwYWNlLmdldFJpZ2h0TGVhZihmYWxzZSk7XG4gICAgICBhd2FpdCBsZWFmLnNldFZpZXdTdGF0ZSh7IHR5cGU6IFZJRVdfVFlQRV9QT01PRE9STywgYWN0aXZlOiB0cnVlIH0pO1xuICAgIH1cblxuICAgIHdvcmtzcGFjZS5yZXZlYWxMZWFmKGxlYWYpO1xuICB9XG5cbiAgYXN5bmMgbG9hZFNldHRpbmdzKCkge1xuICAgIHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1NFVFRJTkdTLCBhd2FpdCB0aGlzLmxvYWREYXRhKCkpO1xuICB9XG5cbiAgYXN5bmMgc2F2ZVNldHRpbmdzKCkge1xuICAgIGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7XG4gIH1cbn1cblxuY2xhc3MgUG9tb2Rvcm9TZXR0aW5nVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XG4gIHBsdWdpbjogUG9tb2Rvcm9QbHVnaW47XG5cbiAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogUG9tb2Rvcm9QbHVnaW4pIHtcbiAgICBzdXBlcihhcHAsIHBsdWdpbik7XG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gIH1cblxuICBkaXNwbGF5KCk6IHZvaWQge1xuICAgIGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG4gICAgY29udGFpbmVyRWwuZW1wdHkoKTtcblxuICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdoMicsIHsgdGV4dDogJ1BvbW9kb3JvIFByb2R1Y3Rpdml0eSBTZXR0aW5ncycgfSk7XG5cbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgIC5zZXROYW1lKCdXb3JrIGR1cmF0aW9uJylcbiAgICAgIC5zZXREZXNjKCdEdXJhdGlvbiBvZiB3b3JrIHNlc3Npb25zIGluIG1pbnV0ZXMnKVxuICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgIC5zZXRQbGFjZWhvbGRlcignMjUnKVxuICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Mud29ya0R1cmF0aW9uLnRvU3RyaW5nKCkpXG4gICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy53b3JrRHVyYXRpb24gPSBwYXJzZUludCh2YWx1ZSkgfHwgMjU7XG4gICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgIH0pKTtcblxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgLnNldE5hbWUoJ0JyZWFrIGR1cmF0aW9uJylcbiAgICAgIC5zZXREZXNjKCdEdXJhdGlvbiBvZiBzaG9ydCBicmVha3MgaW4gbWludXRlcycpXG4gICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgLnNldFBsYWNlaG9sZGVyKCc1JylcbiAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmJyZWFrRHVyYXRpb24udG9TdHJpbmcoKSlcbiAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmJyZWFrRHVyYXRpb24gPSBwYXJzZUludCh2YWx1ZSkgfHwgNTtcbiAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgfSkpO1xuXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAuc2V0TmFtZSgnTG9uZyBicmVhayBkdXJhdGlvbicpXG4gICAgICAuc2V0RGVzYygnRHVyYXRpb24gb2YgbG9uZyBicmVha3MgaW4gbWludXRlcycpXG4gICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgLnNldFBsYWNlaG9sZGVyKCcxNScpXG4gICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5sb25nQnJlYWtEdXJhdGlvbi50b1N0cmluZygpKVxuICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MubG9uZ0JyZWFrRHVyYXRpb24gPSBwYXJzZUludCh2YWx1ZSkgfHwgMTU7XG4gICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgIH0pKTtcblxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgLnNldE5hbWUoJ1Nlc3Npb25zIHVudGlsIGxvbmcgYnJlYWsnKVxuICAgICAgLnNldERlc2MoJ051bWJlciBvZiB3b3JrIHNlc3Npb25zIGJlZm9yZSBhIGxvbmcgYnJlYWsnKVxuICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgIC5zZXRQbGFjZWhvbGRlcignNCcpXG4gICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZXNzaW9uc1VudGlsTG9uZ0JyZWFrLnRvU3RyaW5nKCkpXG4gICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZXNzaW9uc1VudGlsTG9uZ0JyZWFrID0gcGFyc2VJbnQodmFsdWUpIHx8IDQ7XG4gICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgIH0pKTtcblxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgLnNldE5hbWUoJ0F1dG8tc3RhcnQgYnJlYWtzJylcbiAgICAgIC5zZXREZXNjKCdBdXRvbWF0aWNhbGx5IHN0YXJ0IGJyZWFrIHRpbWVycyBhZnRlciB3b3JrIHNlc3Npb25zJylcbiAgICAgIC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxuICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuYXV0b1N0YXJ0QnJlYWtzKVxuICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuYXV0b1N0YXJ0QnJlYWtzID0gdmFsdWU7XG4gICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgIH0pKTtcblxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgLnNldE5hbWUoJ0VuYWJsZSBub3RpZmljYXRpb25zJylcbiAgICAgIC5zZXREZXNjKCdTaG93IG5vdGlmaWNhdGlvbnMgd2hlbiB0aW1lcnMgY29tcGxldGUnKVxuICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG4gICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVOb3RpZmljYXRpb25zKVxuICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlTm90aWZpY2F0aW9ucyA9IHZhbHVlO1xuICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICB9KSk7XG5cblxuICB9XG59Il0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxzQkFBd0Y7QUFZeEYsSUFBTSxtQkFBcUM7QUFBQSxFQUN6QyxjQUFjO0FBQUEsRUFDZCxlQUFlO0FBQUEsRUFDZixtQkFBbUI7QUFBQSxFQUNuQix3QkFBd0I7QUFBQSxFQUN4QixpQkFBaUI7QUFBQSxFQUNqQixxQkFBcUI7QUFBQSxFQUNyQixvQkFBb0I7QUFDdEI7QUFFTyxJQUFNLHFCQUFxQjtBQUUzQixJQUFNLGVBQU4sY0FBMkIseUJBQVM7QUFBQSxFQVV6QyxZQUFZLE1BQXFCLFFBQXdCO0FBQ3ZELFVBQU0sSUFBSTtBQVRaLFNBQVEsUUFBdUI7QUFDL0IsU0FBUSxnQkFBd0I7QUFDaEMsU0FBUSxXQUFvQjtBQUM1QixTQUFRLFVBQW1CO0FBQzNCLFNBQVEsZUFBdUI7QUFDL0IsU0FBUSxlQUFvQztBQUM1QyxTQUFRLGdCQUEwQztBQUloRCxTQUFLLFNBQVM7QUFDZCxTQUFLLGdCQUFnQixPQUFPLFNBQVMsZUFBZTtBQUFBLEVBQ3REO0FBQUEsRUFFQSxjQUFzQjtBQUNwQixXQUFPO0FBQUEsRUFDVDtBQUFBLEVBRUEsaUJBQXlCO0FBQ3ZCLFdBQU87QUFBQSxFQUNUO0FBQUEsRUFFQSxNQUFNLFNBQVM7QUFDYixVQUFNLFlBQVksS0FBSyxZQUFZLFNBQVMsQ0FBQztBQUM3QyxjQUFVLE1BQU07QUFDaEIsY0FBVSxTQUFTLE9BQU8sRUFBRSxLQUFLLHFCQUFxQixDQUFDO0FBQ3ZELFNBQUssV0FBVztBQUFBLEVBQ2xCO0FBQUEsRUFFUSxhQUFhO0FBQ25CLFVBQU0sWUFBWSxLQUFLLFlBQVksY0FBYyxxQkFBcUI7QUFHdEUsUUFBSSxDQUFDLFVBQVUsY0FBYyx5QkFBeUIsR0FBRztBQUN2RCxnQkFBVSxNQUFNO0FBQ2hCLFdBQUssaUJBQWlCLFNBQVM7QUFBQSxJQUNqQyxPQUFPO0FBQ0wsV0FBSyxtQkFBbUI7QUFBQSxJQUMxQjtBQUFBLEVBQ0Y7QUFBQSxFQUVRLGlCQUFpQixXQUF3QjtBQUcvQyxVQUFNLGVBQWUsVUFBVSxTQUFTLE9BQU8sRUFBRSxLQUFLLHlCQUF5QixDQUFDO0FBRWhGLFVBQU0sZUFBZSxhQUFhLFNBQVMsT0FBTyxFQUFFLEtBQUsseUJBQXlCLENBQUM7QUFDbkYsVUFBTSxVQUFVLEtBQUssTUFBTSxLQUFLLGdCQUFnQixFQUFFO0FBQ2xELFVBQU0sVUFBVSxLQUFLLGdCQUFnQjtBQUNyQyxpQkFBYSxjQUFjLEdBQUcsUUFBUSxTQUFTLEVBQUUsU0FBUyxHQUFHLEdBQUcsS0FBSyxRQUFRLFNBQVMsRUFBRSxTQUFTLEdBQUcsR0FBRztBQUV2RyxVQUFNLGdCQUFnQixhQUFhLFNBQVMsT0FBTyxFQUFFLEtBQUssOEJBQThCLENBQUM7QUFDekYsVUFBTSxjQUFjLGNBQWMsU0FBUyxPQUFPLEVBQUUsS0FBSyx3QkFBd0IsQ0FBQztBQUNsRixVQUFNLFlBQVksS0FBSyxXQUNsQixLQUFLLGVBQWUsS0FBSyxPQUFPLFNBQVMsMkJBQTJCLEtBQUssS0FBSyxlQUFlLElBQzVGLEtBQUssT0FBTyxTQUFTLG9CQUNyQixLQUFLLE9BQU8sU0FBUyxpQkFBaUIsS0FDeEMsS0FBSyxPQUFPLFNBQVMsZUFBZTtBQUN4QyxVQUFNLFlBQWEsWUFBWSxLQUFLLGlCQUFpQixZQUFhO0FBQ2xFLGdCQUFZLE1BQU0sUUFBUSxHQUFHO0FBRTdCLFVBQU0sZ0JBQWdCLGFBQWEsU0FBUyxPQUFPLEVBQUUsS0FBSyxvQkFBb0IsQ0FBQztBQUMvRSxVQUFNLFdBQVcsY0FBYyxTQUFTLFVBQVU7QUFBQSxNQUNoRCxLQUFLLEtBQUssV0FBVyx1QkFBdUI7QUFBQSxNQUM1QyxNQUFNLEtBQUssV0FBVyxVQUFVO0FBQUEsSUFDbEMsQ0FBQztBQUNELGFBQVMsVUFBVSxNQUFNLEtBQUssWUFBWTtBQUUxQyxVQUFNLFdBQVcsY0FBYyxTQUFTLFVBQVUsRUFBRSxLQUFLLHNCQUFzQixNQUFNLFFBQVEsQ0FBQztBQUM5RixhQUFTLFVBQVUsTUFBTSxLQUFLLFdBQVc7QUFFekMsVUFBTSxZQUFZLGFBQWEsU0FBUyxPQUFPLEVBQUUsS0FBSyxrQkFBa0IsQ0FBQztBQUN6RSxjQUFVLGNBQWMsS0FBSyxVQUFVLGVBQWUsZ0JBQWdCLEtBQUssZUFBZTtBQUcxRixVQUFNLGVBQWUsVUFBVSxTQUFTLE9BQU8sRUFBRSxLQUFLLHlCQUF5QixDQUFDO0FBQ2hGLGlCQUFhLFNBQVMsTUFBTSxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFFeEQsVUFBTSxtQkFBbUIsYUFBYSxTQUFTLE9BQU8sRUFBRSxLQUFLLDZCQUE2QixDQUFDO0FBRTNGLFFBQUksS0FBSyxPQUFPLFNBQVMsb0JBQW9CO0FBQzNDLFdBQUssZ0JBQWdCLGlCQUFpQixTQUFTLFVBQVU7QUFBQSxRQUN2RCxLQUFLO0FBQUEsUUFDTCxNQUFNO0FBQUEsVUFDSixLQUFLLEtBQUssa0JBQWtCLEtBQUssT0FBTyxTQUFTLGtCQUFrQjtBQUFBLFVBQ25FLGFBQWE7QUFBQSxVQUNiLGlCQUFpQjtBQUFBLFVBQ2pCLE9BQU87QUFBQSxRQUNUO0FBQUEsTUFDRixDQUFDO0FBQUEsSUFDSCxPQUFPO0FBQ0wsWUFBTSxjQUFjLGlCQUFpQixTQUFTLE9BQU87QUFBQSxRQUNuRCxLQUFLO0FBQUEsUUFDTCxNQUFNO0FBQUEsTUFDUixDQUFDO0FBQ0QsV0FBSyxnQkFBZ0I7QUFBQSxJQUN2QjtBQUdBLFVBQU0sZUFBZSxhQUFhLFNBQVMsT0FBTyxFQUFFLEtBQUsseUJBQXlCLENBQUM7QUFFbkYsVUFBTSxXQUFXLGFBQWEsU0FBUyxTQUFTO0FBQUEsTUFDOUMsS0FBSztBQUFBLE1BQ0wsTUFBTTtBQUFBLFFBQ0osTUFBTTtBQUFBLFFBQ04sYUFBYTtBQUFBLE1BQ2Y7QUFBQSxJQUNGLENBQUM7QUFFRCxhQUFTLFFBQVEsS0FBSyxPQUFPLFNBQVM7QUFFdEMsVUFBTSxZQUFZLGFBQWEsU0FBUyxVQUFVO0FBQUEsTUFDaEQsS0FBSztBQUFBLE1BQ0wsTUFBTTtBQUFBLElBQ1IsQ0FBQztBQUVELGNBQVUsVUFBVSxNQUFNO0FBQ3hCLFdBQUssT0FBTyxTQUFTLHFCQUFxQixTQUFTO0FBQ25ELFdBQUssT0FBTyxhQUFhO0FBQ3pCLFdBQUssb0JBQW9CO0FBQUEsSUFDM0I7QUFBQSxFQUNGO0FBQUEsRUFFUSxxQkFBcUI7QUFDM0IsVUFBTSxlQUFlLEtBQUssWUFBWSxjQUFjLHlCQUF5QjtBQUM3RSxVQUFNLGNBQWMsS0FBSyxZQUFZLGNBQWMsd0JBQXdCO0FBQzNFLFVBQU0sWUFBWSxLQUFLLFlBQVksY0FBYyxrQkFBa0I7QUFDbkUsVUFBTSxXQUFXLEtBQUssWUFBWSxjQUFjLDJCQUEyQjtBQUUzRSxRQUFJLGNBQWM7QUFDaEIsWUFBTSxVQUFVLEtBQUssTUFBTSxLQUFLLGdCQUFnQixFQUFFO0FBQ2xELFlBQU0sVUFBVSxLQUFLLGdCQUFnQjtBQUNyQyxtQkFBYSxjQUFjLEdBQUcsUUFBUSxTQUFTLEVBQUUsU0FBUyxHQUFHLEdBQUcsS0FBSyxRQUFRLFNBQVMsRUFBRSxTQUFTLEdBQUcsR0FBRztBQUFBLElBQ3pHO0FBRUEsUUFBSSxhQUFhO0FBQ2YsWUFBTSxZQUFZLEtBQUssV0FDbEIsS0FBSyxlQUFlLEtBQUssT0FBTyxTQUFTLDJCQUEyQixLQUFLLEtBQUssZUFBZSxJQUM1RixLQUFLLE9BQU8sU0FBUyxvQkFDckIsS0FBSyxPQUFPLFNBQVMsaUJBQWlCLEtBQ3hDLEtBQUssT0FBTyxTQUFTLGVBQWU7QUFDeEMsWUFBTSxZQUFhLFlBQVksS0FBSyxpQkFBaUIsWUFBYTtBQUNsRSxrQkFBWSxNQUFNLFFBQVEsR0FBRztBQUFBLElBQy9CO0FBRUEsUUFBSSxXQUFXO0FBQ2IsZ0JBQVUsY0FBYyxLQUFLLFVBQVUsZUFBZSxnQkFBZ0IsS0FBSyxlQUFlO0FBQUEsSUFDNUY7QUFFQSxRQUFJLFVBQVU7QUFDWixlQUFTLGNBQWMsS0FBSyxXQUFXLFVBQVU7QUFDakQsZUFBUyxZQUFZLEtBQUssV0FBVyx1QkFBdUI7QUFBQSxJQUM5RDtBQUFBLEVBQ0Y7QUFBQSxFQUVRLHNCQUFzQjtBQUM1QixVQUFNLG1CQUFtQixLQUFLLFlBQVksY0FBYyw2QkFBNkI7QUFFckYsUUFBSSxrQkFBa0I7QUFDcEIsdUJBQWlCLE1BQU07QUFFdkIsVUFBSSxLQUFLLE9BQU8sU0FBUyxvQkFBb0I7QUFDM0MsYUFBSyxnQkFBZ0IsaUJBQWlCLFNBQVMsVUFBVTtBQUFBLFVBQ3ZELEtBQUs7QUFBQSxVQUNMLE1BQU07QUFBQSxZQUNKLEtBQUssS0FBSyxrQkFBa0IsS0FBSyxPQUFPLFNBQVMsa0JBQWtCO0FBQUEsWUFDbkUsYUFBYTtBQUFBLFlBQ2IsaUJBQWlCO0FBQUEsWUFDakIsT0FBTztBQUFBLFlBQ1AsSUFBSTtBQUFBLFVBQ047QUFBQSxRQUNGLENBQUM7QUFBQSxNQUNILE9BQU87QUFDTCxjQUFNLGNBQWMsaUJBQWlCLFNBQVMsT0FBTztBQUFBLFVBQ25ELEtBQUs7QUFBQSxVQUNMLE1BQU07QUFBQSxRQUNSLENBQUM7QUFDRCxhQUFLLGdCQUFnQjtBQUFBLE1BQ3ZCO0FBQUEsSUFDRjtBQUFBLEVBQ0Y7QUFBQSxFQUVRLGtCQUFrQixLQUFxQjtBQWhOakQ7QUFpTkksUUFBSSxJQUFJLFNBQVMsZ0JBQWdCLEdBQUc7QUFDbEMsWUFBTSxjQUFhLFNBQUksTUFBTSxPQUFPLEVBQUUsQ0FBQyxNQUFwQixtQkFBdUIsTUFBTSxLQUFLO0FBQ3JELGFBQU8sa0RBQWtEO0FBQUEsSUFDM0QsV0FBVyxJQUFJLFNBQVMsVUFBVSxHQUFHO0FBQ25DLFlBQU0sV0FBVSxTQUFJLE1BQU0sSUFBSSxFQUFFLENBQUMsTUFBakIsbUJBQW9CLE1BQU0sS0FBSztBQUMvQyxhQUFPLGlDQUFpQztBQUFBLElBQzFDO0FBQ0EsV0FBTztBQUFBLEVBQ1Q7QUFBQSxFQUVRLGNBQWM7QUFDcEIsUUFBSSxLQUFLLFVBQVU7QUFDakIsV0FBSyxXQUFXO0FBQUEsSUFDbEIsT0FBTztBQUNMLFdBQUssV0FBVztBQUFBLElBQ2xCO0FBQUEsRUFDRjtBQUFBLEVBRVEsYUFBYTtBQUNuQixTQUFLLFdBQVc7QUFDaEIsU0FBSyxRQUFRLE9BQU8sWUFBWSxNQUFNO0FBQ3BDLFdBQUs7QUFDTCxVQUFJLEtBQUssaUJBQWlCLEdBQUc7QUFDM0IsYUFBSyxnQkFBZ0I7QUFBQSxNQUN2QjtBQUNBLFdBQUssbUJBQW1CO0FBQUEsSUFDMUIsR0FBRyxHQUFJO0FBQ1AsU0FBSyxtQkFBbUI7QUFBQSxFQUMxQjtBQUFBLEVBRVEsYUFBYTtBQUNuQixTQUFLLFdBQVc7QUFDaEIsUUFBSSxLQUFLLE9BQU87QUFDZCxvQkFBYyxLQUFLLEtBQUs7QUFDeEIsV0FBSyxRQUFRO0FBQUEsSUFDZjtBQUNBLFNBQUssbUJBQW1CO0FBQUEsRUFDMUI7QUFBQSxFQUVRLGFBQWE7QUFDbkIsU0FBSyxXQUFXO0FBQ2hCLFNBQUssZ0JBQWdCLEtBQUssV0FDckIsS0FBSyxlQUFlLEtBQUssT0FBTyxTQUFTLDJCQUEyQixLQUFLLEtBQUssZUFBZSxJQUM1RixLQUFLLE9BQU8sU0FBUyxvQkFDckIsS0FBSyxPQUFPLFNBQVMsaUJBQWlCLEtBQ3hDLEtBQUssT0FBTyxTQUFTLGVBQWU7QUFDeEMsU0FBSyxtQkFBbUI7QUFBQSxFQUMxQjtBQUFBLEVBRVEsd0JBQXdCO0FBQzlCLFFBQUk7QUFFRixVQUFJLENBQUMsS0FBSyxjQUFjO0FBQ3RCLGFBQUssZUFBZSxLQUFLLE9BQU8sZ0JBQWlCLE9BQWUsb0JBQW9CO0FBQUEsTUFDdEY7QUFFQSxZQUFNLE1BQU0sS0FBSztBQUNqQixZQUFNLE1BQU0sSUFBSTtBQUdoQixZQUFNLGNBQWMsQ0FBQyxRQUFRLFFBQVEsTUFBTTtBQUUzQyxrQkFBWSxRQUFRLENBQUMsTUFBTSxVQUFVO0FBQ25DLGNBQU0sYUFBYSxJQUFJLGlCQUFpQjtBQUN4QyxjQUFNLFdBQVcsSUFBSSxXQUFXO0FBRWhDLG1CQUFXLFFBQVEsUUFBUTtBQUMzQixpQkFBUyxRQUFRLElBQUksV0FBVztBQUVoQyxtQkFBVyxVQUFVLGVBQWUsTUFBTSxNQUFNLFFBQVEsR0FBRztBQUMzRCxtQkFBVyxPQUFPO0FBRWxCLGlCQUFTLEtBQUssZUFBZSxHQUFHLE1BQU0sUUFBUSxHQUFHO0FBQ2pELGlCQUFTLEtBQUssd0JBQXdCLEtBQUssTUFBTSxRQUFRLE1BQU0sSUFBSTtBQUNuRSxpQkFBUyxLQUFLLHdCQUF3QixHQUFHLE1BQU0sUUFBUSxNQUFNLEdBQUc7QUFFaEUsbUJBQVcsTUFBTSxNQUFNLFFBQVEsR0FBRztBQUNsQyxtQkFBVyxLQUFLLE1BQU0sUUFBUSxNQUFNLEdBQUc7QUFBQSxNQUN6QyxDQUFDO0FBQUEsSUFDSCxTQUFTLE9BQVA7QUFDQSxjQUFRLElBQUksc0NBQXNDLEtBQUs7QUFBQSxJQUN6RDtBQUFBLEVBQ0Y7QUFBQSxFQUVBLE1BQWMsa0JBQWtCO0FBQzlCLFNBQUssV0FBVztBQUdoQixTQUFLLHNCQUFzQjtBQUUzQixRQUFJLEtBQUssT0FBTyxTQUFTLHFCQUFxQjtBQUM1QyxVQUFJLHVCQUFPLEtBQUssVUFBVSx3QkFBd0Isd0JBQXdCO0FBQUEsSUFDNUU7QUFFQSxRQUFJLENBQUMsS0FBSyxTQUFTO0FBRWpCLFdBQUs7QUFHTCxXQUFLLFVBQVU7QUFDZixZQUFNLGNBQWMsS0FBSyxlQUFlLEtBQUssT0FBTyxTQUFTLDJCQUEyQjtBQUN4RixXQUFLLGlCQUFpQixjQUFjLEtBQUssT0FBTyxTQUFTLG9CQUFvQixLQUFLLE9BQU8sU0FBUyxpQkFBaUI7QUFBQSxJQUNySCxPQUFPO0FBRUwsV0FBSyxVQUFVO0FBQ2YsV0FBSyxnQkFBZ0IsS0FBSyxPQUFPLFNBQVMsZUFBZTtBQUFBLElBQzNEO0FBRUEsUUFBSSxLQUFLLE9BQU8sU0FBUyxpQkFBaUI7QUFDeEMsaUJBQVcsTUFBTSxLQUFLLFdBQVcsR0FBRyxHQUFJO0FBQUEsSUFDMUM7QUFFQSxTQUFLLG1CQUFtQjtBQUFBLEVBQzFCO0FBQUEsRUFFQSxNQUFNLFVBQVU7QUFDZCxRQUFJLEtBQUssT0FBTztBQUNkLG9CQUFjLEtBQUssS0FBSztBQUFBLElBQzFCO0FBR0EsUUFBSSxLQUFLLGNBQWM7QUFDckIsV0FBSyxhQUFhLE1BQU07QUFDeEIsV0FBSyxlQUFlO0FBQUEsSUFDdEI7QUFBQSxFQUNGO0FBQ0Y7QUFFQSxJQUFxQixpQkFBckIsY0FBNEMsdUJBQU87QUFBQSxFQUdqRCxNQUFNLFNBQVM7QUFDYixVQUFNLEtBQUssYUFBYTtBQUV4QixTQUFLO0FBQUEsTUFDSDtBQUFBLE1BQ0EsQ0FBQyxTQUFTLElBQUksYUFBYSxNQUFNLElBQUk7QUFBQSxJQUN2QztBQUVBLFNBQUssY0FBYyxTQUFTLDhCQUE4QixNQUFNO0FBQzlELFdBQUssYUFBYTtBQUFBLElBQ3BCLENBQUM7QUFFRCxTQUFLLFdBQVc7QUFBQSxNQUNkLElBQUk7QUFBQSxNQUNKLE1BQU07QUFBQSxNQUNOLFVBQVUsTUFBTTtBQUNkLGFBQUssYUFBYTtBQUFBLE1BQ3BCO0FBQUEsSUFDRixDQUFDO0FBRUQsU0FBSyxjQUFjLElBQUksbUJBQW1CLEtBQUssS0FBSyxJQUFJLENBQUM7QUFBQSxFQUMzRDtBQUFBLEVBRUEsTUFBTSxlQUFlO0FBQ25CLFVBQU0sRUFBRSxVQUFVLElBQUksS0FBSztBQUUzQixRQUFJLE9BQTZCO0FBQ2pDLFVBQU0sU0FBUyxVQUFVLGdCQUFnQixrQkFBa0I7QUFFM0QsUUFBSSxPQUFPLFNBQVMsR0FBRztBQUNyQixhQUFPLE9BQU8sQ0FBQztBQUFBLElBQ2pCLE9BQU87QUFDTCxhQUFPLFVBQVUsYUFBYSxLQUFLO0FBQ25DLFlBQU0sS0FBSyxhQUFhLEVBQUUsTUFBTSxvQkFBb0IsUUFBUSxLQUFLLENBQUM7QUFBQSxJQUNwRTtBQUVBLGNBQVUsV0FBVyxJQUFJO0FBQUEsRUFDM0I7QUFBQSxFQUVBLE1BQU0sZUFBZTtBQUNuQixTQUFLLFdBQVcsT0FBTyxPQUFPLENBQUMsR0FBRyxrQkFBa0IsTUFBTSxLQUFLLFNBQVMsQ0FBQztBQUFBLEVBQzNFO0FBQUEsRUFFQSxNQUFNLGVBQWU7QUFDbkIsVUFBTSxLQUFLLFNBQVMsS0FBSyxRQUFRO0FBQUEsRUFDbkM7QUFDRjtBQUVBLElBQU0scUJBQU4sY0FBaUMsaUNBQWlCO0FBQUEsRUFHaEQsWUFBWSxLQUFVLFFBQXdCO0FBQzVDLFVBQU0sS0FBSyxNQUFNO0FBQ2pCLFNBQUssU0FBUztBQUFBLEVBQ2hCO0FBQUEsRUFFQSxVQUFnQjtBQUNkLFVBQU0sRUFBRSxZQUFZLElBQUk7QUFDeEIsZ0JBQVksTUFBTTtBQUVsQixnQkFBWSxTQUFTLE1BQU0sRUFBRSxNQUFNLGlDQUFpQyxDQUFDO0FBRXJFLFFBQUksd0JBQVEsV0FBVyxFQUNwQixRQUFRLGVBQWUsRUFDdkIsUUFBUSxzQ0FBc0MsRUFDOUMsUUFBUSxVQUFRLEtBQ2QsZUFBZSxJQUFJLEVBQ25CLFNBQVMsS0FBSyxPQUFPLFNBQVMsYUFBYSxTQUFTLENBQUMsRUFDckQsU0FBUyxPQUFPLFVBQVU7QUFDekIsV0FBSyxPQUFPLFNBQVMsZUFBZSxTQUFTLEtBQUssS0FBSztBQUN2RCxZQUFNLEtBQUssT0FBTyxhQUFhO0FBQUEsSUFDakMsQ0FBQyxDQUFDO0FBRU4sUUFBSSx3QkFBUSxXQUFXLEVBQ3BCLFFBQVEsZ0JBQWdCLEVBQ3hCLFFBQVEscUNBQXFDLEVBQzdDLFFBQVEsVUFBUSxLQUNkLGVBQWUsR0FBRyxFQUNsQixTQUFTLEtBQUssT0FBTyxTQUFTLGNBQWMsU0FBUyxDQUFDLEVBQ3RELFNBQVMsT0FBTyxVQUFVO0FBQ3pCLFdBQUssT0FBTyxTQUFTLGdCQUFnQixTQUFTLEtBQUssS0FBSztBQUN4RCxZQUFNLEtBQUssT0FBTyxhQUFhO0FBQUEsSUFDakMsQ0FBQyxDQUFDO0FBRU4sUUFBSSx3QkFBUSxXQUFXLEVBQ3BCLFFBQVEscUJBQXFCLEVBQzdCLFFBQVEsb0NBQW9DLEVBQzVDLFFBQVEsVUFBUSxLQUNkLGVBQWUsSUFBSSxFQUNuQixTQUFTLEtBQUssT0FBTyxTQUFTLGtCQUFrQixTQUFTLENBQUMsRUFDMUQsU0FBUyxPQUFPLFVBQVU7QUFDekIsV0FBSyxPQUFPLFNBQVMsb0JBQW9CLFNBQVMsS0FBSyxLQUFLO0FBQzVELFlBQU0sS0FBSyxPQUFPLGFBQWE7QUFBQSxJQUNqQyxDQUFDLENBQUM7QUFFTixRQUFJLHdCQUFRLFdBQVcsRUFDcEIsUUFBUSwyQkFBMkIsRUFDbkMsUUFBUSw2Q0FBNkMsRUFDckQsUUFBUSxVQUFRLEtBQ2QsZUFBZSxHQUFHLEVBQ2xCLFNBQVMsS0FBSyxPQUFPLFNBQVMsdUJBQXVCLFNBQVMsQ0FBQyxFQUMvRCxTQUFTLE9BQU8sVUFBVTtBQUN6QixXQUFLLE9BQU8sU0FBUyx5QkFBeUIsU0FBUyxLQUFLLEtBQUs7QUFDakUsWUFBTSxLQUFLLE9BQU8sYUFBYTtBQUFBLElBQ2pDLENBQUMsQ0FBQztBQUVOLFFBQUksd0JBQVEsV0FBVyxFQUNwQixRQUFRLG1CQUFtQixFQUMzQixRQUFRLHNEQUFzRCxFQUM5RCxVQUFVLFlBQVUsT0FDbEIsU0FBUyxLQUFLLE9BQU8sU0FBUyxlQUFlLEVBQzdDLFNBQVMsT0FBTyxVQUFVO0FBQ3pCLFdBQUssT0FBTyxTQUFTLGtCQUFrQjtBQUN2QyxZQUFNLEtBQUssT0FBTyxhQUFhO0FBQUEsSUFDakMsQ0FBQyxDQUFDO0FBRU4sUUFBSSx3QkFBUSxXQUFXLEVBQ3BCLFFBQVEsc0JBQXNCLEVBQzlCLFFBQVEseUNBQXlDLEVBQ2pELFVBQVUsWUFBVSxPQUNsQixTQUFTLEtBQUssT0FBTyxTQUFTLG1CQUFtQixFQUNqRCxTQUFTLE9BQU8sVUFBVTtBQUN6QixXQUFLLE9BQU8sU0FBUyxzQkFBc0I7QUFDM0MsWUFBTSxLQUFLLE9BQU8sYUFBYTtBQUFBLElBQ2pDLENBQUMsQ0FBQztBQUFBLEVBR1I7QUFDRjsiLAogICJuYW1lcyI6IFtdCn0K
